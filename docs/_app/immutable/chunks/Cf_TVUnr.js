import{at as f}from"./BYTqjnmQ.js";import{g as m,b as A,r as R}from"./DShqRj6q.js";function i(t,e,n,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}function _(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var l,a,c,p;const L="__TAURI_TO_IPC_KEY__";function U(t,e=!1){return window.__TAURI_INTERNALS__.transformCallback(t,e)}class ${constructor(e){l.set(this,void 0),a.set(this,0),c.set(this,[]),p.set(this,void 0),_(this,l,e||(()=>{})),this.id=U(n=>{const r=n.index;if("end"in n){r==i(this,a,"f")?this.cleanupCallback():_(this,p,r);return}const s=n.message;if(r==i(this,a,"f")){for(i(this,l,"f").call(this,s),_(this,a,i(this,a,"f")+1);i(this,a,"f")in i(this,c,"f");){const g=i(this,c,"f")[i(this,a,"f")];i(this,l,"f").call(this,g),delete i(this,c,"f")[i(this,a,"f")],_(this,a,i(this,a,"f")+1)}i(this,a,"f")===i(this,p,"f")&&this.cleanupCallback()}else i(this,c,"f")[r]=s})}cleanupCallback(){Reflect.deleteProperty(window,`_${this.id}`)}set onmessage(e){_(this,l,e)}get onmessage(){return i(this,l,"f")}[(l=new WeakMap,a=new WeakMap,c=new WeakMap,p=new WeakMap,L)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[L]()}}class j{constructor(e,n,r){this.plugin=e,this.event=n,this.channelId=r}async unregister(){return d(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}}async function W(t,e,n){const r=new $(n);return d(`plugin:${t}|registerListener`,{event:e,handler:r}).then(()=>new j(t,e,r.id))}async function d(t,e={},n){return window.__TAURI_INTERNALS__.invoke(t,e,n)}async function v(t){return await d("plugin:sharetarget|ping",{payload:{value:t}}).then(e=>e.value?e.value:null)}async function O(t){return await W("sharetarget","share",t)}async function q(t,e){await d("plugin:clipboard-manager|write_text",{label:e==null?void 0:e.label,text:t})}async function S(){return await d("plugin:clipboard-manager|read_text")}function H(t){return t.replaceAll("**","")}function D(t,e=1){let n=t.split(" ");for(;n.length>e;)n.shift();return n.join(" ").trim()}function F(t){return t.replace(/s$/,"")}function K(t){return t.replaceAll(/^\s+(\/\/.*)?/gm,"").replaceAll(`
`,"")}function Y(t,e,n=!1){if(typeof t=="string")return t;if(t*=10**e,t=Math.round(t),t/=10**e,n){if(u(t,1/2))return"1/2";if(u(t,1/3))return"1/3";if(u(t,1/4))return"1/4";if(u(t,1/8))return"1/8";if(u(t,2/3))return"2/3";if(u(t,3/4))return"3/4"}return t}function Z(t){return!isNaN(Number(t))&&!isNaN(parseFloat(t))}function u(t,e){return Math.abs(t-e)<.01}function Q(t,e){return t.split(/(\*\*[^\*]+\*\*)/).map(n=>n.startsWith("**")&&n.endsWith("**")?n:e(n)).join("")}function V(t,e){e=e.toLowerCase().trim();let n=F(D(e));return t[n]?n:e.replaceAll(/\s/g,"_")}function X(t,e){return e.length-t.length}function tt(t){if(T(t))return!1;let e=[];h()||(e=["www.simplyrecipes.com","www.allrecipes.com"]);const n=new URL(t);return e.includes(n.hostname)}function T(t){return t.startsWith("custom-recipe")}function w(t){if(!t||!t.length||t.length>500)return!1;if(T(t))return!0;try{let e=new URL(t);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}}function et(t){return new URL(document.location).searchParams.get(t)}function nt(t,e){const n=new URL(window.location.href);n.searchParams.set(t,e),R(n.toString(),{})}function rt(t){const e=new URL(window.location.href);e.searchParams.delete(t),R(e.toString(),{})}function it(){let t=new URL(document.location),e=t.searchParams.get("link")||t.searchParams.get("description")||t.searchParams.get("url");return e?(e.startsWith("http")||(e=e.replace(/.+?(?=http)/,"")),decodeURIComponent(e)):null}async function at(){if(h())try{return await S()}catch(t){console.error(t)}else{const t=await navigator.clipboard.read();for(const e of t)try{return await(await e.getType("text/plain")).text()}catch(n){console.error(n)}}N("Didn't find a recipe url in your clipboard. Sorry bud :/")}async function st(){if(h())try{let t=await S();if(w(t))return t}catch(t){console.error(t)}else{const t=await navigator.clipboard.read();for(const e of t)try{let r=await(await e.getType("text/plain")).text();if(w(r)||(r=decodeURIComponent(r),w(r)))return r}catch(n){console.error(n)}}N("Didn't find a recipe url in your clipboard. Sorry bud :/")}async function ot(t,e){await m(b(t,e),{state:{is_going_back:!0}})}async function M(t,e){await m(b(t,e),{})}async function lt(t,e){await m(b(t,e==null?void 0:e.query_params),{state:{...e==null?void 0:e.page_data}})}function b(t,e){t.startsWith("/")||(t=`/${t}`);let n=`${A}${t}`;if(e){let r=new URLSearchParams;for(let s of Object.keys(e))r.append(s,e[s]);n+=`?${r.toString()}`}return n}function ct(t,e,n="",r=!1,s=!1){var k,C,I;if(s&&!t.starred||r&&((k=t.tags)!=null&&k.length)||n&&!((C=t.tags)!=null&&C.some(o=>o==n)))return!1;let g=e.toLowerCase().split(" ").map(o=>o.trim()).filter(o=>o.length),P=t.title.toLowerCase(),y=(I=t.url)==null?void 0:I.toLowerCase();for(let o of g)if(P.indexOf(o)===-1&&(!y||y.indexOf(o)===-1))return!1;return!0}let x=0;const ut=t=>`${t}_${++x}`,ft=()=>{x=0};function _t(t){return new Promise(e=>setTimeout(e,t))}async function dt(t){h()?await q(t):await navigator.clipboard.writeText(t)}function h(){return!!(window.__TAURI__||window.__TAURI_INTERNALS__)}let J=0;const E=f([]);function N(t,e=""){E.update(n=>[...n,{text:t,extra_class:e,id:++J}])}function ht(t){E.update(e=>{let n=[...e];for(let r=0;r<n.length;r++)n[r]&&n[r]===t&&(n.splice(r,1),r-=1);return n})}const pt=f(void 0),z=f(null);window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),z.set(t)});const wt=f(null),gt=f([]),mt=f([]);h()&&!window.share_target_setup&&(window.share_target_setup=!0,(async()=>{function t(n){return console.log({text:n}),w(n)?(M("/my-recipes/recipe",{url:decodeURIComponent(n)}),!0):!1}await O(async n=>{n.text&&t(n.text)}),(async()=>{try{let n=await v("doesn't matter"),r=JSON.parse(n||"[]");r.reverse();for(let s of r)if(t(s))break}catch(n){console.error(n)}})()})());export{D as A,Q as B,H as C,h as D,T as E,ft as F,ut as G,V as H,it as I,ht as J,E as K,gt as a,M as b,mt as c,st as d,lt as e,et as f,b as g,Z as h,tt as i,wt as j,rt as k,pt as l,_t as m,N as n,at as o,ot as p,z as q,ct as r,nt as s,d as t,K as u,w as v,dt as w,X as x,Y as y,u as z};
