import{aJ as f}from"./CBx8egCH.js";import{g as m,b as T,r as I}from"./h2pgyqrt.js";function i(e,t,n,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}function _(e,t,n,r,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var l,s,c,h;const C="__TAURI_TO_IPC_KEY__";function N(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}class P{constructor(t){l.set(this,void 0),s.set(this,0),c.set(this,[]),h.set(this,void 0),_(this,l,t||(()=>{})),this.id=N(n=>{const r=n.index;if("end"in n){r==i(this,s,"f")?this.cleanupCallback():_(this,h,r);return}const a=n.message;if(r==i(this,s,"f")){for(i(this,l,"f").call(this,a),_(this,s,i(this,s,"f")+1);i(this,s,"f")in i(this,c,"f");){const g=i(this,c,"f")[i(this,s,"f")];i(this,l,"f").call(this,g),delete i(this,c,"f")[i(this,s,"f")],_(this,s,i(this,s,"f")+1)}i(this,s,"f")===i(this,h,"f")&&this.cleanupCallback()}else i(this,c,"f")[r]=a})}cleanupCallback(){Reflect.deleteProperty(window,`_${this.id}`)}set onmessage(t){_(this,l,t)}get onmessage(){return i(this,l,"f")}[(l=new WeakMap,s=new WeakMap,c=new WeakMap,h=new WeakMap,C)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[C]()}}class A{constructor(t,n,r){this.plugin=t,this.event=n,this.channelId=r}async unregister(){return d(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}}async function U(e,t,n){const r=new P(n);return d(`plugin:${e}|registerListener`,{event:t,handler:r}).then(()=>new A(e,t,r.id))}async function d(e,t={},n){return window.__TAURI_INTERNALS__.invoke(e,t,n)}async function $(e){return await d("plugin:sharetarget|ping",{payload:{value:e}}).then(t=>t.value?t.value:null)}async function j(e){return await U("sharetarget","share",e)}async function x(e,t){await d("plugin:clipboard-manager|write_text",{label:t==null?void 0:t.label,text:e})}async function O(){return await d("plugin:clipboard-manager|read_text")}function B(e){return e.replaceAll("**","")}function W(e,t=1){let n=e.split(" ");for(;n.length>t;)n.shift();return n.join(" ").trim()}function q(e){return e.replace(/s$/,"")}function G(e){return e.replaceAll(/^\s+(\/\/.*)?/gm,"").replaceAll(`
`,"")}function H(e,t,n=!1){if(typeof e=="string")return e;if(e*=10**t,e=Math.round(e),e/=10**t,n){if(u(e,1/2))return"1/2";if(u(e,1/3))return"1/3";if(u(e,1/4))return"1/4";if(u(e,1/8))return"1/8";if(u(e,2/3))return"2/3";if(u(e,3/4))return"3/4"}return e}function K(e){return!isNaN(Number(e))&&!isNaN(parseFloat(e))}function u(e,t){return Math.abs(e-t)<.01}function Y(e,t){return e.split(/(\*\*[^\*]+\*\*)/).map(n=>n.startsWith("**")&&n.endsWith("**")?n:t(n)).join("")}function Z(e,t){t=t.toLowerCase().trim();let n=q(W(t));return e[n]?n:t.replaceAll(/\s/g,"_")}function Q(e,t){return t.length-e.length}function V(e){let t=[];w()||(t=["www.simplyrecipes.com","www.allrecipes.com"]);const n=new URL(e);return t.includes(n.hostname)}function p(e){if(!e||!e.length||e.length>500)return!1;try{let t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}function X(e){return new URL(document.location).searchParams.get(e)}function ee(e,t){const n=new URL(window.location.href);n.searchParams.set(e,t),I(n.toString(),{})}function te(e){const t=new URL(window.location.href);t.searchParams.delete(e),I(t.toString(),{})}function ne(){let e=new URL(document.location),t=e.searchParams.get("link")||e.searchParams.get("description")||e.searchParams.get("url");return t?decodeURIComponent(t):null}async function re(){if(w())try{let e=await O();if(p(e))return e}catch(e){console.error(e)}else{const e=await navigator.clipboard.read();e:for(const t of e)try{let r=await(await t.getType("text/plain")).text();if(p(r)||(r=decodeURIComponent(r),p(r)))return r;break e}catch(n){console.error(n)}}M("Didn't find a recipe url in your clipboard. Sorry bud :/")}async function ie(e,t){await m(b(e,t),{state:{is_going_back:!0}})}async function v(e,t){await m(b(e,t),{})}async function se(e,t){await m(b(e,t==null?void 0:t.query_params),{state:{...t==null?void 0:t.page_data}})}function b(e,t){e.startsWith("/")||(e=`/${e}`);let n=`${T}${e}`;if(t){let r=new URLSearchParams;for(let a of Object.keys(t))r.append(a,t[a]);n+=`?${r.toString()}`}return n}function ae(e,t,n="",r=!1,a=!1){var y,k;if(a&&!e.starred||r&&((y=e.tags)!=null&&y.length)||n&&!((k=e.tags)!=null&&k.some(o=>o==n)))return!1;let g=t.toLowerCase().split(" ").map(o=>o.trim()).filter(o=>o.length),E=e.title.toLowerCase(),S=e.url.toLowerCase();for(let o of g)if(E.indexOf(o)===-1&&S.indexOf(o)===-1)return!1;return!0}let L=0;const oe=e=>`${e}_${++L}`,le=()=>{L=0};function ce(e){return new Promise(t=>setTimeout(t,e))}async function ue(e){w()?await x(e):await navigator.clipboard.writeText(e)}function w(){return!!(window.__TAURI__||window.__TAURI_INTERNALS__)}let F=0;const R=f([]);function M(e,t=""){R.update(n=>[...n,{text:e,extra_class:t,id:++F}])}function fe(e){R.update(t=>{let n=[...t];for(let r=0;r<n.length;r++)n[r]&&n[r]===e&&(n.splice(r,1),r-=1);return n})}const _e=f(void 0),D=f(null);window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),D.set(e)});const de=f(null),he=f([]),pe=f([]);w()&&!window.share_target_setup&&(window.share_target_setup=!0,(async()=>{function e(n){return console.log({text:n}),p(n)?(v("/my-recipes/recipe",{url:decodeURIComponent(n)}),!0):!1}await j(async n=>{n.text&&e(n.text)}),(async()=>{try{let n=await $("doesn't matter"),r=JSON.parse(n||"[]");r.reverse();for(let a of r)if(e(a))break}catch(n){console.error(n)}})()})());export{Y as A,B,w as C,le as D,oe as E,Z as F,ne as G,fe as H,R as I,he as a,re as b,se as c,v as d,pe as e,X as f,b as g,K as h,V as i,de as j,te as k,_e as l,ce as m,M as n,ie as o,D as p,d as q,ae as r,ee as s,G as t,Q as u,p as v,ue as w,H as x,u as y,W as z};
