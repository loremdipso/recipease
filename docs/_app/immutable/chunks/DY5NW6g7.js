import{aJ as f}from"./CBx8egCH.js";import{g as m,b as N,r as I}from"./NG2IHnbz.js";function i(t,e,n,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}function _(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var l,a,c,p;const C="__TAURI_TO_IPC_KEY__";function P(t,e=!1){return window.__TAURI_INTERNALS__.transformCallback(t,e)}class A{constructor(e){l.set(this,void 0),a.set(this,0),c.set(this,[]),p.set(this,void 0),_(this,l,e||(()=>{})),this.id=P(n=>{const r=n.index;if("end"in n){r==i(this,a,"f")?this.cleanupCallback():_(this,p,r);return}const s=n.message;if(r==i(this,a,"f")){for(i(this,l,"f").call(this,s),_(this,a,i(this,a,"f")+1);i(this,a,"f")in i(this,c,"f");){const g=i(this,c,"f")[i(this,a,"f")];i(this,l,"f").call(this,g),delete i(this,c,"f")[i(this,a,"f")],_(this,a,i(this,a,"f")+1)}i(this,a,"f")===i(this,p,"f")&&this.cleanupCallback()}else i(this,c,"f")[r]=s})}cleanupCallback(){Reflect.deleteProperty(window,`_${this.id}`)}set onmessage(e){_(this,l,e)}get onmessage(){return i(this,l,"f")}[(l=new WeakMap,a=new WeakMap,c=new WeakMap,p=new WeakMap,C)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[C]()}}class U{constructor(e,n,r){this.plugin=e,this.event=n,this.channelId=r}async unregister(){return d(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}}async function $(t,e,n){const r=new A(n);return d(`plugin:${t}|registerListener`,{event:e,handler:r}).then(()=>new U(t,e,r.id))}async function d(t,e={},n){return window.__TAURI_INTERNALS__.invoke(t,e,n)}async function j(t){return await d("plugin:sharetarget|ping",{payload:{value:t}}).then(e=>e.value?e.value:null)}async function v(t){return await $("sharetarget","share",t)}async function O(t,e){await d("plugin:clipboard-manager|write_text",{label:e==null?void 0:e.label,text:t})}async function L(){return await d("plugin:clipboard-manager|read_text")}function B(t){return t.replaceAll("**","")}function W(t,e=1){let n=t.split(" ");for(;n.length>e;)n.shift();return n.join(" ").trim()}function q(t){return t.replace(/s$/,"")}function G(t){return t.replaceAll(/^\s+(\/\/.*)?/gm,"").replaceAll(`
`,"")}function H(t,e,n=!1){if(typeof t=="string")return t;if(t*=10**e,t=Math.round(t),t/=10**e,n){if(u(t,1/2))return"1/2";if(u(t,1/3))return"1/3";if(u(t,1/4))return"1/4";if(u(t,1/8))return"1/8";if(u(t,2/3))return"2/3";if(u(t,3/4))return"3/4"}return t}function K(t){return!isNaN(Number(t))&&!isNaN(parseFloat(t))}function u(t,e){return Math.abs(t-e)<.01}function Y(t,e){return t.split(/(\*\*[^\*]+\*\*)/).map(n=>n.startsWith("**")&&n.endsWith("**")?n:e(n)).join("")}function Z(t,e){e=e.toLowerCase().trim();let n=q(W(e));return t[n]?n:e.replaceAll(/\s/g,"_")}function Q(t,e){return e.length-t.length}function V(t){let e=[];h()||(e=["www.simplyrecipes.com","www.allrecipes.com"]);const n=new URL(t);return e.includes(n.hostname)}function w(t){if(!t||!t.length||t.length>500)return!1;try{let e=new URL(t);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}}function X(t){return new URL(document.location).searchParams.get(t)}function tt(t,e){const n=new URL(window.location.href);n.searchParams.set(t,e),I(n.toString(),{})}function et(t){const e=new URL(window.location.href);e.searchParams.delete(t),I(e.toString(),{})}function nt(){let t=new URL(document.location),e=t.searchParams.get("link")||t.searchParams.get("description")||t.searchParams.get("url");return e?decodeURIComponent(e):null}async function rt(){if(h())try{return await L()}catch(t){console.error(t)}else{const t=await navigator.clipboard.read();for(const e of t)try{return await(await e.getType("text/plain")).text()}catch(n){console.error(n)}}T("Didn't find a recipe url in your clipboard. Sorry bud :/")}async function it(){if(h())try{let t=await L();if(w(t))return t}catch(t){console.error(t)}else{const t=await navigator.clipboard.read();for(const e of t)try{let r=await(await e.getType("text/plain")).text();if(w(r)||(r=decodeURIComponent(r),w(r)))return r}catch(n){console.error(n)}}T("Didn't find a recipe url in your clipboard. Sorry bud :/")}async function at(t,e){await m(b(t,e),{state:{is_going_back:!0}})}async function D(t,e){await m(b(t,e),{})}async function st(t,e){await m(b(t,e==null?void 0:e.query_params),{state:{...e==null?void 0:e.page_data}})}function b(t,e){t.startsWith("/")||(t=`/${t}`);let n=`${N}${t}`;if(e){let r=new URLSearchParams;for(let s of Object.keys(e))r.append(s,e[s]);n+=`?${r.toString()}`}return n}function ot(t,e,n="",r=!1,s=!1){var y,k;if(s&&!t.starred||r&&((y=t.tags)!=null&&y.length)||n&&!((k=t.tags)!=null&&k.some(o=>o==n)))return!1;let g=e.toLowerCase().split(" ").map(o=>o.trim()).filter(o=>o.length),x=t.title.toLowerCase(),E=t.url.toLowerCase();for(let o of g)if(x.indexOf(o)===-1&&E.indexOf(o)===-1)return!1;return!0}let R=0;const lt=t=>`${t}_${++R}`,ct=()=>{R=0};function ut(t){return new Promise(e=>setTimeout(e,t))}async function ft(t){h()?await O(t):await navigator.clipboard.writeText(t)}function h(){return!!(window.__TAURI__||window.__TAURI_INTERNALS__)}function _t(){return!1}let F=0;const S=f([]);function T(t,e=""){S.update(n=>[...n,{text:t,extra_class:e,id:++F}])}function dt(t){S.update(e=>{let n=[...e];for(let r=0;r<n.length;r++)n[r]&&n[r]===t&&(n.splice(r,1),r-=1);return n})}const ht=f(void 0),M=f(null);window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),M.set(t)});const pt=f(null),wt=f([]),gt=f([]);h()&&!window.share_target_setup&&(window.share_target_setup=!0,(async()=>{function t(n){return console.log({text:n}),w(n)?(D("/my-recipes/recipe",{url:decodeURIComponent(n)}),!0):!1}await v(async n=>{n.text&&t(n.text)}),(async()=>{try{let n=await j("doesn't matter"),r=JSON.parse(n||"[]");r.reverse();for(let s of r)if(t(s))break}catch(n){console.error(n)}})()})());export{u as A,W as B,Y as C,B as D,h as E,ct as F,lt as G,Z as H,nt as I,dt as J,S as K,wt as a,it as b,st as c,D as d,gt as e,X as f,b as g,K as h,V as i,pt as j,et as k,ht as l,ut as m,T as n,_t as o,rt as p,at as q,ot as r,tt as s,M as t,d as u,w as v,ft as w,G as x,Q as y,H as z};
