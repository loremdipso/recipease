import{n as vt,a as w,d as ft,t as O,s as K}from"../chunks/CfNwE0Bq.js";import{p as mt,z as j,A as x,as as bt,d as gt,f as Q,c as n,C as ht,s as _,a as kt,B as p,i as t,G as D,r as i,t as yt}from"../chunks/awlFoezV.js";import{s as xt}from"../chunks/BBaQ3y4Z.js";import{i as wt}from"../chunks/CCHAIv3B.js";import{e as $t}from"../chunks/CIRKoOug.js";import{s as Ct}from"../chunks/B2xZ0dDQ.js";import{t as Rt,s as Pt}from"../chunks/DSIY89X_.js";import{s as St,a as At,b as Mt}from"../chunks/BCsxFzkL.js";import{a as qt}from"../chunks/CAe7mk4b.js";import{j as F,g as jt,e as Dt,h as Ft,m as Ot,o as zt,p as Bt,s as U,y as Lt,z as Nt,k as Tt}from"../chunks/QCCBpY_l.js";import{C as Gt}from"../chunks/Dw4Z4ONU.js";import{M as Yt}from"../chunks/CqqWtxbX.js";import"../chunks/Bv02EmYY.js";import{P as Et}from"../chunks/O-DgXc8G.js";import{R as V}from"../chunks/BqyqdJ53.js";import{S as Ht}from"../chunks/D2ZDVfRA.js";import{T as It}from"../chunks/CaE9AZHH.js";import{A as Jt}from"../chunks/BosheT8n.js";import{O as Kt}from"../chunks/J7rGuDky.js";import{R as Qt}from"../chunks/Bfno1uPc.js";import{R as Ut}from"../chunks/DoqRHI9Y.js";var Vt=vt('<svg viewBox="0 -12 32 32" width="16px" height="16px" style="min-width: 16px" fill="#ffffff"><g transform="translate(-414.000000, -1049.000000)" fill="#ffffff"><path d="M442,1049 L418,1049 C415.791,1049 414,1050.79 414,1053 C414,1055.21 415.791,1057 418,1057 L442,1057 C444.209,1057 446,1055.21 446,1053 C446,1050.79 444.209,1049 442,1049"></path></g></svg>');function Wt(l){var r=Vt();w(l,r)}function Xt(l,r){p(r,{},!0)}var Zt=(l,r)=>{Dt(t(r).id),Ft("/shopping-lists")},te=(l,r,c)=>{l.stopPropagation(),p(r,t(c),!0)},ee=(l,r,c)=>{l.stopPropagation(),r(t(c))},ae=(l,r,c)=>{l.stopPropagation(),r(t(c))},re=(l,r,c)=>{l.stopPropagation(),r(t(c),.5)},se=(l,r,c)=>{l.stopPropagation(),r(t(c),0)},oe=O('<div><button class="grow vertically-centered gap1 white-text" title="See preview" aria-label="See preview"><!> <h2> </h2></button> <div class="shrink flex-col centered"><div class="shrink vertically-centered"><button title="Add to list" aria-label="Add to list"><!></button> <b title="Count" aria-label="Count"> </b> <button title="Add to list" aria-label="Add to list"><!></button></div> <div class="shrink vertically-centered justify-center"><button title="Make a half batch" aria-label="Make a half batch">Â½</button> <button title="Reset" aria-label="Reset"><!></button></div></div></div>'),ie=(l,r)=>{l.stopPropagation(),p(r,null)},le=O('<button class="close-button svelte-48x7r2" title="Close" aria-label="Close"><!></button> <!>',1),ne=O('<div class="card has-list gap1 flex-col pt0"><div class="flex-row gap1 p0 pt0_5"><button class="blue rounded icon-button ph0"><!> Reset</button> <button class="red rounded icon-button p0_5"><!> Delete list</button> <h3 class="vertically-centered rounded ph0 icon-button"><!> Autosaved</h3></div> <div class="rounded-bottom black p0_5 pt2"><!></div> <div class="list"></div></div> <!> <!>',1);function Me(l,r){mt(r,!0);const[c,W]=St(),z=()=>At(F,"$current_list_name",c);F.set(X());function X(){const e=new Date,a=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),v=String(e.getDate()).padStart(2,"0");return`${o}-${v}-${a} list`}let B=j(jt().reverse()),$=x(j([])),s=x(j({})),f=x(null),u=x(-1),m=ht(()=>({id:t(u),name:z()||"",items:Z(),checked_items:{}}));bt(()=>{L()}),qt(()=>{L()});function L(){if(t(u)!==-1)return;let e=null,a=Ot("id");if(a!==null&&zt(a))if(p(u,Number(a),!0),e=Bt(t(u)),e){U(t(u)),p(s,{},!0),p(u,e.id,!0),Mt(F,e.name);for(let o of e.items)t(s)[o.recipe_url]?t(s)[o.recipe_url]+=o.quantity:t(s)[o.recipe_url]=o.quantity}else p(u,Lt(xt(t(m))),!0),U(t(u)),Nt("id",t(u).toString())}gt(()=>{z()&&t(m).id>=0&&Tt(t(m))});function Z(){let e=[];for(let a of Object.keys(t(s)))for(let o of B)if(o.url===a){e.push({recipe_url:o.url,quantity:t(s)[a]});break}return e}function tt(e,a){a<=0?delete t(s)[e.url]:t(s)[e.url]=a}function N(e,a=1){t(s)[e.url]?t(s)[e.url]+=a:t(s)[e.url]=a}function et(e){t(s)[e.url]&&(t(s)[e.url]-=1,t(s)[e.url]<=0&&delete t(s)[e.url])}var T=ne(),C=Q(T),R=n(C),b=n(R);b.__click=[Xt,s];var at=n(b);V(at),D(),i(b);var g=_(b,2);g.__click=[Zt,m];var rt=n(g);It(rt),D(),i(g);var G=_(g,2),st=n(G);Ht(st),D(),i(G),i(R);var P=_(R,2),ot=n(P);Qt(ot,{get all_recipes(){return B},get recipes(){return t($)},set recipes(e){p($,e,!0)}}),i(P);var Y=_(P,2);$t(Y,21,()=>t($),e=>e.url,(e,a)=>{var o=oe();let v;var d=n(o);d.__click=[te,f,a];var h=n(d);Yt(h);var k=_(h,2),nt=n(k,!0);i(k),i(d);var H=_(d,2),S=n(H),y=n(S);y.__click=[ee,et,a];var _t=n(y);Wt(_t),i(y);var A=_(y,2),ct=n(A,!0);i(A);var M=_(A,2);M.__click=[ae,N,a];var ut=n(M);Et(ut),i(M),i(S);var I=_(S,2),J=n(I);J.__click=[re,N,a];var q=_(J,2);q.__click=[se,tt,a];var dt=n(q);V(dt),i(q),i(I),i(H),i(o),yt(pt=>{v=Ct(o,1,"flex-row flex-end vertically-centered",null,v,pt),K(nt,t(a).title||"<missing title>"),K(ct,t(s)[t(a).url]||0)},[()=>({selected:(t(s)[t(a).url]||0)>0})]),Rt(3,o,()=>Pt),w(e,o)}),i(Y),i(C);var E=_(C,2);{var it=e=>{Kt(e,{click:()=>{p(f,null)},content:o=>{var v=le(),d=Q(v);d.__click=[ie,f];var h=n(d);Gt(h),i(d);var k=_(d,2);Ut(k,{get recipe(){return t(f)},show_colors:!0}),w(o,v)},$$slots:{content:!0}})};wt(E,e=>{t(f)&&e(it)})}var lt=_(E,2);Jt(lt,{}),w(l,T),kt(),W()}ft(["click"]);export{Me as component};
